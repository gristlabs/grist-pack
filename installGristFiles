#!/bin/bash

# Define the paths to the files
script_dir=$(dirname "$0")
localfile_path="$script_dir/rc.local"
restartgrist_path="$script_dir/restartGrist"
gristparameters_path="$script_dir/gristParameters"
dexyaml_path="$script_dir/dex.yaml"  # Add this line

instalation_path="~/grist"

# Check if the files exist
for file_path in "$localfile_path" "$restartgrist_path" "$gristparameters_path" "$dexyaml_path"; do  # Add "$dexyaml_path"
    if [ ! -f "$file_path" ]; then
        echo "File not found: $file_path"
        exit 1
    fi
done

# Add execute permissions to the files
for file_path in "$localfile_path" "$restartgrist_path" "$gristparameters_path"; do
    chmod +x "$file_path"
    if [ $? -ne 0 ]; then
        echo "Failed to change permissions for: $file_path"
        exit 1
    fi
done

# Check if ~/grist exists and create it if it doesn't
if [ ! -d $instalation_path ]; then
    mkdir $instalation_path
fi

# Move the files to their destinations
# Rc.local is moved to /etc
mv "$localfile_path" /etc
if [ $? -ne 0 ]; then
    echo "Failed to move file: $localfile_path"
    exit 1
fi

# The rest of the files are moved to ~/grist
mv "$restartgrist_path" $instalation_path
mv "$gristparameters_path" $instalation_path
mv "$dexyaml_path" $instalation_path 
if [ $? -ne 0 ]; then
    echo "Failed to move file: $restartgrist_path or $gristparameters_path or $dexyaml_path"
    exit 1
fi

#!/bin/bash

# Define the paths to the files
script_dir=$(dirname "$0")
localfile_path="$script_dir/rc.local"
restartgrist_path="$script_dir/restartGrist"
gristparameters_path="$script_dir/gristParameters"

# Check if the files exist
for file_path in "$localfile_path" "$restartgrist_path" "$gristparameters_path"; do
    if [ ! -f "$file_path" ]; then
        echo "File not found: $file_path"
        exit 1
    fi
done

# Add execute permissions to the files
for file_path in "$localfile_path" "$restartgrist_path" "$gristparameters_path"; do
    chmod +x "$file_path"
    if [ $? -ne 0 ]; then
        echo "Failed to change permissions for: $file_path"
        exit 1
    fi
done

# Move the files to their destinations
mv "$localfile_path" /etc/
if [ $? -ne 0 ]; then
    echo "Failed to move file: $localfile_path"
    exit 1
fi

# Check if /etc/grist exists and create it if it doesn't
if [ ! -d "/etc/grist" ]; then
    mkdir /etc/grist
fi

mv "$restartgrist_path" /etc/grist
mv "$gristparameters_path" /etc/grist
if [ $? -ne 0 ]; then
    echo "Failed to move file: $restartgrist_path or $gristparameters_path"
    exit 1
fi

# Remove the script's directory
cd ..
rm -rf "$script_dir"